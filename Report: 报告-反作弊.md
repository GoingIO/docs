title: 渠道反作弊报告
notebook: 糖豆
tags: 机器学习,渠道反作弊

[TOC]

# 摘要



# 数据集
反作弊数据挖掘的数据来源是用户的账号基本信息以及用户访问app的底层接口数据。由于是对渠道新增用户做判断，所以训练集用了数据中``新增用户`` ``首日``的数据特征。通过数据的清洗，整理和特征的融合， 每天的样本数据在``4w ~ 6w`` 之间。

为了保证时效性，模型每天进行训练更新，训练的总体数据使用``训练当日`` 往前``30``天内所有的 ``新增用户`` ``首日``的数据特征。

经渠道部门整理，沟通， 从总体数据中筛选出六个渠道的数据, 包括``gf``, ``yingyongbao``, ``alading``, ``xiaomi``, ``360``, ``A004``, 作为训练模型的样本，数据量为``` 50~60W```条，将  ``gf``, ``yingyongbao``, ``alading`` 标记为正样本， ``xiaomi``, ``360``, ``A004`` 标记为负样本， 随机抽取其中``70%``作为训练样本集， 将剩余的``30``作为校验样本集， 对模型进行训练和校验


# 校验方法
利用校验样本集，对模型进行预测，对预测结果与实际的校验集的标定结果进行对比， 并计算```准确率```, ```精确度```, ```召回率```以及```F值```

# 校验结果及结论
经过多次迭代，调参， 给定模型的 ``准确率`` 为``0.9255067001190875``, ``精确度``为``	0.932085791``	``召回率``为``0.929891944``, ``F值``为``0.9255142720996273``

从数据上可以看出， 各项指标都比较高， 总结原因如下：
1. 目前样本中一些类别性特征虽然做了标量化，但在整个训练过程中并没有发挥类别性特征的作用， 需要在之后的训练中加入对类别性特征的训练
2. 正负样本人为的标定，而且粒度较大，造成训练样本本身不够准确， 这也是在之后的迭代中需要着重处理的问题
3. 训练模型时的参数也需要做进一步的调整。

# 总结

### 九个指标

|     	参数       |		f1      	   |				    |				     |			准确率		  |													           |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| (gini,5,30)	  | 0.8705576906697263 | 0.8733944993139644 | 0.8688002293046997 | 0.8688002293046997 | 181418,134036,47382,129790,51628,120012,9778 ,37604,14024  |
| (gini,5,50) 	  | 0.8706241934716408 | 0.8734505079630557 | 0.8688718870233384 | 0.8688718870233384 | 181418,134036,47382,129801,51617,120024,9777 ,37605,14012  |
| (gini,5,80)     | 0.8706241934716408 | 0.8734505079630557 | 0.8688718870233384 | 0.8688718870233384 | 181418,134036,47382,129801,51617,120024,9777 ,37605,14012  |
| (gini,5,100)	  | 0.8706191364566627 | 0.87344639297404   | 0.8688663748911354 | 0.8688663748911354 | 181418,134036,47382,129800,51618,120023,9777 ,37605,14013  |
| (gini,8,30)	  | 0.8743214232862366 | 0.8757214135071458 | 0.8732981291823303 | 0.8732981291823303 | 181418,134036,47382,131558,49860,121304,10254,37128,12732  |
| (gini,8,50)	  | 0.8751270748947475 | 0.8773244360261279 | 0.8736950027009448 | 0.8736950027009448 | 181418,134036,47382,130488,50930,120805,9683 ,37699,13231  |
| (gini,8,80)	  | 0.8752709988851055 | 0.8776134973627119 | 0.8737721725517864 | 0.8737721725517865 | 181418,134036,47382,130308,51110,120722,9586 ,37796,13314  |
| (gini,8,100)	  | 0.8746757600977539 | 0.8761101912275219 | 0.873634369246712  | 0.873634369246712  | 181418,134036,47382,131505,49913,121308,10197,37185,12728  |
| (gini,15,30)	  | 0.8739952524519716 | 0.8757755900779929 | 0.8727634523586414 | 0.8727634523586414 | 181418,134036,47382,131037,50381,120995,10042,37340,13041  |
| (gini,15,50)	  | 0.8749317524611422 | 0.8765530719526811 | 0.8737887089483954 | 0.8737887089483954 | 181418,134036,47382,131241,50177,121190,10051,37331,12846  |
| (gini,15,80)    | 0.8745288963071084 | 0.8763339438214641 | 0.8732871049179243 | 0.8732871049179244 | 181418,134036,47382,130998,50420,121023,9975 ,37407,13013  |
| (gini,15,100)   | 0.8748522428808843 | 0.8766892394823953 | 0.8735957843212911 | 0.8735957843212911 | 181418,134036,47382,130952,50466,121028,9924 ,37458,13008  |
| (entropy,5,30)  | 0.8705631175937087 | 0.8733495773242479 | 0.8688277899657145 | 0.8688277899657145 | 181418,134036,47382,129847,51571,120043,9804 ,37578,13993  |
| (entropy,5,50)  | 0.8706650246150953 | 0.8734345123338054 | 0.8689380326097742 | 0.8689380326097741 | 181418,134036,47382,129865,51553,120062,9803 ,37579,13974  |
| (entropy,5,80)  | 0.8706650246150953 | 0.8734345123338054 | 0.8689380326097742 | 0.8689380326097741 | 181418,134036,47382,129865,51553,120062,9803 ,37579,13974  |
| (entropy,5,100) | 0.8706599673226655 | 0.8734303900251267 | 0.8689325204775711 | 0.8689325204775711 | 181418,134036,47382,129864,51554,120061,9803 ,37579,13975  |
| (entropy,8,30)  | 0.8739486709897035 | 0.8751067286397654 | 0.8730666196298051 | 0.8730666196298053 | 181418,134036,47382,131918,49500,121463,10455,36927,12573  |
| (entropy,8,50)  | 0.8743789932225661 | 0.8756317035950689 | 0.8734414446196078 | 0.8734414446196077 | 181418,134036,47382,131772,49646,121424,10348,37034,12612  |
| (entropy,8,80)  | 0.8746231839556283 | 0.8765494670059706 | 0.8733201777111422 | 0.8733201777111422 | 181418,134036,47382,130838,50580,120946,9892 ,37490,13090  |
| (entropy,8,100) | 0.8739356629849658 | 0.8749663005874064 | 0.873132765216241  | 0.873132765216241  | 181418,134036,47382,132114,49304,121567,10547,36835,12469  |
| (entropy,15,30) | 0.8752343371138791 | 0.8764563655426308 | 0.8743178736398814 | 0.8743178736398813 | 181418,134036,47382,131809,49609,121522,10287,37095,12514  |
| (entropy,15,50) | 0.8761219965379129 | 0.8773681275994891 | 0.875194302660155  | 0.875194302660155) | 181418,134036,47382,131764,49654,121579,10185,37197,12457  |
| (entropy,15,80) | 0.8760457132081519 | 0.8774170041634205 | 0.8750454750906747 | 0.8750454750906745 | 181418,134036,47382,131581,49837,121474,10107,37275,12562  |
| (entropy,15,100)| 0.8760392106371027 | 0.877567175871367  | 0.8749517688432239 | 0.8749517688432239 | 181418,134036,47382,131358,50060,121354,10004,37378,12682  |



### 30个指标

#### 决策树参数及效果

|     	参数       |		f1      	   |				    |				     |	准确率				  |								  				         |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|(gini,5,30)		|  0.8756663984014568 | 0.8767618331817589 | 0.8748245306194069 | 0.8748245306194069 | 182368,135046,47322,133012,49356,122615,10397,36925,12431 |
|(gini,5,50)		|  0.8756663984014568 | 0.8767618331817589 | 0.8748245306194069 | 0.8748245306194069 | 182368,135046,47322,133012,49356,122615,10397,36925,12431 |
|(gini,5,80)		|  0.8756663984014568 | 0.8767618331817589 | 0.8748245306194069 | 0.8748245306194069 | 182368,135046,47322,133012,49356,122615,10397,36925,12431 |
|(gini,5,100)		|  0.8756663984014568 | 0.8767618331817589 | 0.8748245306194069 | 0.8748245306194069 | 182368,135046,47322,133012,49356,122615,10397,36925,12431 |
|(gini,8,30)		|  0.8789778639672012 | 0.8805943572933717 | 0.8778513774346377 | 0.8778513774346377 | 182368,135046,47322,132216,50152,122493,9723 ,37599,12553 |
|(gini,8,50)		|  0.878963978019436  | 0.8805748122923156 | 0.8778404105983506 | 0.8778404105983506 | 182368,135046,47322,132224,50144,122496,9728 ,37594,12550 |
|(gini,8,80)		|  0.878586735134939  | 0.8799845153202095 | 0.877577206527461  | 0.877577206527461  | 182368,135046,47322,132530,49838,122625,9905 ,37417,12421 |
|(gini,8,100)		|  0.87895613257269   | 0.8805728077242463 | 0.8778294437620635 | 0.8778294437620635 | 182368,135046,47322,132216,50152,122491,9725 ,37597,12555 |
|(gini,10,30)	  | 0.8814400859616296 	| 0.8843064647771625	| 0.8797594090594782	| 0.8797594090594782	| 182218,134867,47351,130443,51775,121700,8743,38608,13167 |
|(gini,10,50)	  | 0.881435353001509  	| 0.8845254952437929	| 0.8796661142148416	| 0.8796661142148415	| 182218,134867,47351,130192,52026,121566,8626,38725,13301 |
|(gini,10,80)	  | 0.8814275543201295	| 0.8845540239974221	| 0.8796441624866917	| 0.8796441624866917	| 182218,134867,47351,130152,52066,121544,8608,38743,13323 |
|(gini,10,100)	  | 0.8815004593330351	| 0.8845762473873524	| 0.8797374573313285	| 0.8797374573313284	| 182218,134867,47351,130207,52011,121580,8627,38724,13287 |
|(gini,15,30)		|  0.8823623168154331 | 0.8864318499443014 | 0.880247631163362  | 0.880247631163362  | 182368,135046,47322,129333,53035,121270,8063 ,39259,13776 |
|(gini,15,50)		|  0.8827381303082455 | 0.8870140558993765 | 0.8805601859975434 | 0.8805601859975434 | 182368,135046,47322,129124,53244,121194,7930 ,39392,13852 |
|(gini,15,80)		|  0.8826524088945497 | 0.8866179214229337 | 0.880576636251974  | 0.880576636251974  | 182368,135046,47322,129433,52935,121350,8083 ,39239,13696 |
|(gini,15,100)		|  0.8825813121966216 | 0.8869417522166081 | 0.8803737497806633 | 0.8803737497806633 | 182368,135046,47322,129044,53324,121137,7907 ,39415,13909 |
|(gini,20,30)		|  0.876848178845858  | 0.8827015593530947 | 0.874095236006317  | 0.8740952360063169 | 182368,135046,47322,127765,54603,119925,7840 ,39482,15121 |
|(gini,20,50)		|  0.8773519013952283 | 0.8832911180143916 | 0.8745832602210915 | 0.8745832602210915 | 182368,135046,47322,127684,54684,119929,7755 ,39567,15117 |
|(gini,20,80)		|  0.8773995631493596 | 0.8831639545280245 | 0.874681961747675  | 0.874681961747675  | 182368,135046,47322,127834,54534,120013,7821 ,39501,15033 |
|(gini,20,100)		|  0.8773684639059531 | 0.8832514861928236 | 0.8746161607299526 | 0.8746161607299526 | 182368,135046,47322,127732,54636,119956,7776 ,39546,15090 |
|(gini,25,30)		|  0.871018135038395  | 0.8785796944064126 | 0.8676851201965257 | 0.8676851201965257 | 182368,135046,47322,126452,55916,118684,7768 ,39554,16362 |
|(gini,25,50)		|  0.8725505700647058 | 0.8798876329997563 | 0.8693082119670118 | 0.8693082119670118 | 182368,135046,47322,126606,55762,118909,7697 ,39625,16137 |
|(gini,25,80)		|  0.8710458674132497 | 0.8788449815513716 | 0.8676522196876645 | 0.8676522196876645 | 182368,135046,47322,126268,56100,118589,7679 ,39643,16457 |
|(gini,25,100)		|  0.8718882718651211 | 0.879493249498843  | 0.8685624670994911 | 0.8685624670994911 | 182368,135046,47322,126406,55962,118741,7665 ,39657,16305 |
|(entropy,5,30)		|  0.87389010308162   | 0.8757201558538591 | 0.8726256799438498 | 0.8726256799438498 | 182368,135046,47322,131987,50381,121902,10085,37237,13144 |
|(entropy,5,50)		|  0.87389010308162   | 0.8757201558538591 | 0.8726256799438498 | 0.8726256799438498 | 182368,135046,47322,131987,50381,121902,10085,37237,13144 |
|(entropy,5,80)		|  0.87389010308162   | 0.8757201558538591 | 0.8726256799438498 | 0.8726256799438498 | 182368,135046,47322,131987,50381,121902,10085,37237,13144 |
|(entropy,5,100)	|  0.87389010308162   | 0.8757201558538591 | 0.8726256799438498 | 0.8726256799438498 | 182368,135046,47322,131987,50381,121902,10085,37237,13144 |
|(entropy,8,30)		|  0.8783706462913736 | 0.8796567685988324 | 0.8774236708194421 | 0.8774236708194421 | 182368,135046,47322,132696,49672,122694,10002,37320,12352 |
|(entropy,8,50)		|  0.878453099240922  | 0.8797976313033888 | 0.8774730215827338 | 0.8774730215827338 | 182368,135046,47322,132609,49759,122655,9954 ,37368,12391 |
|(entropy,8,80)		|  0.8783541773895822 | 0.8797364693988846 | 0.8773523863835762 | 0.877352386383576  | 182368,135046,47322,132555,49813,122617,9938 ,37384,12429 |
|(entropy,8,100)	|  0.87821604314591   | 0.8794804056262888 | 0.87728110194771   | 0.8772811019477101 | 182368,135046,47322,132730,49638,122698,10032,37290,12348 |
|(entropy,10,30)  | 0.8809383387943526	| 0.8841926721252883	| 0.8791008572149842	| 0.8791008572149842	| 182218,134867,47351,130019,52199,121428,8591,38760,13439 |
|(entropy,10,50)  | 0.8810344441562348	| 0.884226933367518		| 0.8792215917198082	| 0.8792215917198082	| 182218,134867,47351,130085,52133,121472,8613,38738,13395 |
|(entropy,10,80)  | 0.8810419515333711	| 0.8841687130086688	| 0.8792545193120328	| 0.8792545193120328	| 182218,134867,47351,130157,52061,121511,8646,38705,13356 |
|(entropy,10,100) | 0.8813285965789127	| 0.8845954573450209	| 0.8794905003896432	| 0.8794905003896432	| 182218,134867,47351,130000,52218,121454,8546,38805,13413 |
|(entropy,15,30)	|  0.8819932285136153 | 0.8860922006607728 | 0.8798637918933147 | 0.8798637918933147 | 182368,135046,47322,129309,53059,121223,8086 ,39236,13823 |
|(entropy,15,50)	|  0.8820759351479209 | 0.8860337317164051 | 0.8799953939287594 | 0.8799953939287595 | 182368,135046,47322,129449,52919,121305,8144 ,39178,13741 |
|(entropy,15,80)	|  0.8825135932867454 | 0.8863252561487364 | 0.8804889015616775 | 0.8804889015616775 | 182368,135046,47322,129591,52777,121421,8170 ,39152,13625 |
|(entropy,15,100)	|  0.8828550937150703 | 0.8867632429700043 | 0.8808014563958588 | 0.8808014563958589 | 182368,135046,47322,129488,52880,121398,8090 ,39232,13648 |
|(entropy,20,30)	|  0.8782947536804251 | 0.883668054883427  | 0.8757073609405158 | 0.8757073609405159 | 182368,135046,47322,128165,54203,120272,7893 ,39429,14774 |
|(entropy,20,50)	|  0.8782700274643279 | 0.8838175112393842 | 0.8756305930865064 | 0.8756305930865064 | 182368,135046,47322,128011,54357,120188,7823 ,39499,14858 |
|(entropy,20,80)	|  0.8781130664458429 | 0.883455699162068  | 0.8755318915599227 | 0.8755318915599228 | 182368,135046,47322,128195,54173,120271,7924 ,39398,14775 |
|(entropy,20,100)	|  0.8788715529333344 | 0.884243384671153  | 0.876294086681874  | 0.876294086681874  | 182368,135046,47322,128158,54210,120322,7836 ,39486,14724 |
|(entropy,25,30)	|  0.8732622990545821 | 0.8800132057825838 | 0.8701910422881207 | 0.8701910422881207 | 182368,135046,47322,127065,55303,119219,7846 ,39476,15827 |
|(entropy,25,50)	|  0.8733202017923196 | 0.8801266974569288 | 0.870234909633269  | 0.870234909633269  | 182368,135046,47322,127019,55349,119200,7819 ,39503,15846 |
|(entropy,25,80)	|  0.8726429071512412 | 0.8798794933554245 | 0.8694288471661695 | 0.8694288471661695 | 182368,135046,47322,126684,55684,118959,7725 ,39597,16087 |
|(entropy,25,100)	|  0.8724581755134564 | 0.8795220476833525 | 0.8692862782944377 | 0.8692862782944376 | 182368,135046,47322,126824,55544,119016,7808 ,39514,16030 |

#### 随机森林参数及效果


| RF参数	        |         f1       | weightedPrecision| weightedRecall   | accuracy         |总样本 |正样本|负样本| 预测正|预测负|本正预正|本负预正|本负预负|本正预负| 准确率      |     精确度       |    召回率         |      f1          |
|---------------|------------------|------------------|------------------|------------------|---------------------------------------------------|-----|------------------|------------------|------------------|------------------|
|(10,gini,5,10)	|0.8576441205676731|0.8567527911699571|0.8589633172968792|0.8589633172968792|182293|134707|47586|137331|44962|123164|14167|33419|11543|0.8589633172968792|0.8968404802994225|0.914310317949327 |0.9054911446195016|
|(10,gini,5,30)	|0.8631599658847271|0.8626606760225386|0.8637577965144027|0.8637577965144027|182293|134707|47586|135969|46324|122920|13049|34537|11787|0.8637577965144027|0.9040295949812089|0.9124989792661109|0.9082445432916106|
|(10,gini,8,10)	|0.8734957675902305|0.8738833732742493|0.8731492706796201|0.8731492706796202|182293|134707|47586|133891|48402|122737|11154|36432|11970|0.8731492706796202|0.9166934297301537|0.9111404752536988|0.9139085175615604|
|(10,gini,8,30)	|0.875033299706903 |0.8757153071331057|0.8744658324784824|0.8744658324784824|182293|134707|47586|133343|48950|122583|10760|36826|12124|0.8744658324784824|0.9193058503258513|0.9099972532978984|0.9146278679350868|
|(10,gini,10,10)|0.876842209921281 |0.8776703479087705|0.8761773628170033|0.8761773628170034|182293|134707|47586|133079|49214|122607|10472|37114|12100|0.8761773628170034|0.9213098986316398|0.9101754177585426|0.9157088122605365|
|(10,gini,10,30)|0.8781437330520536|0.8790622051323392|0.8774226108517607|0.8774226108517607|182293|134707|47586|132918|49375|122640|10278|37308|12067|0.8774226108517607|0.9226741299146842|0.9104203938919284|0.916506305464736 |
|(20,gini,5,10)	|0.8606099894713456|0.8598382467311259|0.8616787260070325|0.8616787260070327|182293|134707|47586|136892|45401|123192|13700|33886|11515|0.8616787260070327|0.8999211056891564|0.9145181764867453|0.9071609247456728|
|(20,gini,5,30)	|0.8611375947978311|0.860366381882968 |0.8622108364007395|0.8622108364007395|182293|134707|47586|136909|45384|123249|13660|33926|11458|0.8622108364007395|0.9002256973610209|0.9149413170807753|0.907523857210179 |
|(20,gini,8,10)	|0.8741430337904275|0.8745242639094576|0.8738020659048894|0.8738020659048894|182293|134707|47586|133900|48393|122801|11099|36487|11906|0.8738020659048894|0.917109783420463 |0.9116155804820834|0.9143544285889795|
|(20,gini,8,30)	|0.8737908256733584|0.8740264213194401|0.8735716675900884|0.8735716675900885|182293|134707|47586|134192|48101|122926|11266|36320|11781|0.8735716675900885|0.9160456659115297|0.912543520381272 |0.9142912394616566|
|(20,gini,10,10)|0.8771191769911013|0.8778628714598324|0.8765119889408809|0.8765119889408809|182293|134707|47586|133220|49073|122708|10512|37074|11999|0.8765119889408809|0.9210929289896412|0.910925193197087 |0.9159808455288194|
|(20,gini,10,30)|0.8779326684035348|0.8787540774072673|0.8772744976493887|0.8772744976493886|182293|134707|47586|133081|49212|122708|10373|37213|11999|0.8772744976493886|0.9220549890668089|0.910925193197087 |0.9164563012532301|
|(30,gini,5,10)	|0.8595864531732421|0.8587983444814573|0.8606803333095621|0.8606803333095621|182293|134707|47586|136926|45367|123118|13808|33778|11589|0.8606803333095621|0.8991572090034033|0.9139688360664256|0.9065025236256272|
|(30,gini,5,30)	|0.85674159884213  |0.8557995810512994|0.8581898372400476|0.8581898372400476|182293|134707|47586|137560|44733|123208|14352|33234|11499|0.8581898372400476|0.8956673451584763|0.9146369527938415|0.9050527607091569|
|(30,gini,8,10)	|0.8736947234324063|0.8739019859063104|0.8735003538259835|0.8735003538259835|182293|134707|47586|134251|48042|122949|11302|36284|11758|0.8735003538259835|0.9158144073414723|0.9127142613227226|0.9142617062887142|
|(30,gini,8,30)	|0.8739837521885774|0.8741891413081103|0.8737910945565656|0.8737910945565656|182293|134707|47586|134254|48039|122977|11277|36309|11730|0.8737910945565656|0.9160025027187272|0.9129221198601409|0.9144597172080711|
|(30,gini,10,10)|0.877520781316346 |0.8781960212905446|0.8769618142221588|0.8769618142221588|182293|134707|47586|133336|48957|122807|10529|37057|11900|0.8769618142221588|0.9210340793184136|0.9116601215972444|0.9163231272594323|
|(30,gini,10,30)|0.8773628174838439|0.878039310842409 |0.8768027296714629|0.876802729671463 |182293|134707|47586|133335|48958|122792|10543|37043|11915|0.876802729671463 |0.9209284883938951|0.9115487688093418|0.9162146230814574|
|(50,gini,5,10)	|0.8570339976371175|0.8560750740554344|0.8585464060605728|0.8585464060605729|182293|134707|47586|137687|44606|123304|14383|33203|11403|0.8585464060605729|0.8955384313697008|0.9153496106364183|0.9053356535019126|
|(50,gini,5,30)	|0.8633088806809728|0.8626875811189493|0.864103393986604 |0.864103393986604 |182293|134707|47586|136376|45917|123155|13221|34365|11552|0.864103393986604 |0.9030547896990673|0.9142435062765855|0.9086147047214321|
|(50,gini,8,10)	|0.8734239990619626|0.8735921580434056|0.8732644698370207|0.8732644698370207|182293|134707|47586|134334|47959|122969|11365|36221|11738|0.8732644698370207|0.9153974421963167|0.9128627317065928|0.9141283298828059|
|(50,gini,8,30)	|0.8759632357231701|0.8764638708140833|0.8755300532658962|0.8755300532658961|182293|134707|47586|133663|48630|122840|10823|36763|11867|0.8755300532658961|0.9190277040018554|0.9119050977306302|0.9154525468569513|
|(50,gini,10,10)|0.8772530870543894|0.8779215402048186|0.8766985018623864|0.8766985018623864|182293|134707|47586|133350|48943|122790|10560|37026|11917|0.8766985018623864|0.9208098987626546|0.9115339217709547|0.9161484311172623|
|(50,gini,10,30)|0.8779355235860877|0.8787120902749018|0.8773074116943602|0.8773074116943602|182293|134707|47586|133157|49136|122749|10408|37178|11958|0.8773074116943602|0.9218366289417755|0.9112295574840209|0.9165024042051191|
